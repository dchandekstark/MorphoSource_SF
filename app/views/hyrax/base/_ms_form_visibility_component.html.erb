<% if f.object.embargo_release_date %>
  <%= render 'form_permission_under_embargo', f: f %>
<% elsif f.object.lease_expiration_date %>
  <%= render 'form_permission_under_lease', f: f %>
<% else %>
    <fieldset>
      <legend class="legend-save-work">Publication Status</legend>
      <ul id="publication-options" class="visibility">
        <span id="selected_visibility" class=<%= (f.object.model.fileset_accessibility.first || 'new') %>></span>
        <li class="radio">
          <label>
            <%= f.radio_button :visibility, Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_PUBLIC, data: { 'target': '#collapsePublic', 'toggle':'collapse' } %>
            <span class="label label-success">Publish with Open Download</span>
            <br />
            <%= t('morphosource.visibility.open.note_html', type: f.object.human_readable_type) %>
            <div class="collapse" id="collapsePublic" data-parent="#publication-options">
              <%= t('morphosource.visibility.open.warning_html') %>
            </div>
          </label>
        </li>
        <li class="radio">
          <label>
            <%= f.radio_button :visibility, "restricted_download", data: { 'target': '#collapseRestricted', 'toggle':'collapse' } %>
            <span class="label label-info">Publish with Restricted Download</span>
            <br />
            <%= t('morphosource.visibility.restricted.note_html', type: f.object.human_readable_type) %>
            <div class="collapse" id="collapseRestricted" data-parent="#publication-options">
              <%= t('morphosource.visibility.restricted.warning_html') %>
            </div>
          </label>
        </li>
        <li class="radio">
          <label>
            <%= f.radio_button :visibility, "preview", data: { 'target': '#collapsePreview', 'toggle':'collapse' } %>
            <span class="label label-info">Publish with No Download</span>
            <br />
            <%= t('morphosource.visibility.preview.note_html', type: f.object.human_readable_type) %>
            <div class="collapse" id="collapsePreview" data-parent="#publication-options">
              <%= t('morphosource.visibility.preview.warning_html') %>
            </div>
          </label>
        </li>
        <li class="radio">
          <label>
            <%= f.radio_button :visibility, "hidden", data: { 'target': '#collapseHidden', 'toggle':'collapse' } %>
            <span class="label label-info">Publish with Hidden File</span>
            <br />
            <%= t('morphosource.visibility.hidden.note_html', type: f.object.human_readable_type) %>
            <div class="collapse" id="collapseHidden" data-parent="#publication-options">
              <%= t('morphosource.visibility.hidden.warning_html') %>
            </div>
          </label>
        </li>
        <li class="radio">
          <label>
            <%= f.radio_button :visibility, Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_PRIVATE %>
            <%= visibility_badge(Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_PRIVATE) %>
            <br />
            <%= t('hyrax.visibility.restricted.note_html') %>
          </label>
        </li>
        <li class="radio">
          <label>
            <%= f.radio_button :visibility, Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_EMBARGO, data: { 'target': '#collapseEmbargo', 'toggle':'collapse' } %>
            <%= visibility_badge(Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_EMBARGO) %>
            <br />
            <%= t('hyrax.visibility.embargo.note_html') %>
            <div class="collapse" id="collapseEmbargo" data-parent="#publication-options">
              <div class="form-inline">
                <%= f.input :visibility_during_embargo, wrapper: :inline, collection: visibility_options(:restrict), include_blank: false %>
                <%= t('hyrax.works.form.visibility_until') %>
                <%= f.date_field :embargo_release_date, wrapper: :inline, value: f.object.embargo_release_date || Date.tomorrow, class: 'datepicker form-control' %>
                <%= f.input :visibility_after_embargo, wrapper: :inline, collection: visibility_options(:loosen), include_blank: false %>
              </div>
            </div>
          </label>
        </li>
        <li class="radio">
          <label>
            <%= f.radio_button :visibility, Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_LEASE, data: { 'target': '#collapseLease', 'toggle':'collapse' } %>
            <%= visibility_badge(Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_LEASE) %>
            <br />
            <%= t('hyrax.visibility.lease.note_html') %>
            <div class="collapse" id="collapseLease" data-parent="#publication-options">
              <div class="form-inline">
                <%= f.input :visibility_during_lease, wrapper: :inline, collection: visibility_options(:loosen), include_blank: false %>
                <%= t('hyrax.works.form.visibility_until') %>
                <%= f.date_field :lease_expiration_date, wrapper: :inline, value: f.object.lease_expiration_date || Date.tomorrow, class: 'datepicker form-control' %>
                <%= f.input :visibility_after_lease, wrapper: :inline, collection: visibility_options(:restrict), include_blank: false %>
              </div>
            </div>
          </label>
        </li>
      </ul>
    </fieldset>
<% end %>
